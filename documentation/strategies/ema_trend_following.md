# Стратегія: EMA Trend Following

## Огляд

Це трендова стратегія, розроблена для торгівлі на ринках з чітко вираженим напрямком руху. Основна ідея полягає в тому, щоб ідентифікувати початок нового тренду за допомогою перетину двох експоненційних ковзних середніх (EMA) і входити в позицію в напрямку цього тренду.

Для підвищення якості сигналів стратегія використовує додаткові фільтри, такі як індекс відносної сили (RSI) та аналіз обсягів торгів.

## Логіка та умови

### Умови для входу в довгу позицію (Long)

Позиція Long відкривається, коли виконуються **всі** наступні умови:

1.  **Золотий хрест (Golden Cross):** Швидка EMA (напр., EMA 20) перетинає повільну EMA (напр., EMA 50) знизу вгору.
2.  **Нахил EMA:** Обидві ковзні середні (швидка та повільна) спрямовані вгору, що підтверджує висхідний тренд.
3.  **Імпульс (RSI Filter):** Значення індикатора RSI знаходиться вище рівня 50. Це свідчить про перевагу покупців. ( *Цей фільтр можна ввімкнути/вимкнути* )
4.  **Підтвердження обсягом (Volume Filter):** Обсяг поточної свічки перевищує середній обсяг за останній період. Це підтверджує силу руху. ( *Цей фільтр можна ввімкнути/вимкнути* )

### Умови для входу в коротку позицію (Short)

Позиція Short відкривається, коли виконуються **всі** наступні умови:

1.  **Хрест смерті (Death Cross):** Швидка EMA перетинає повільну EMA зверху вниз.
2.  **Нахил EMA:** Обидві ковзні середні спрямовані вниз, що підтверджує низхідний тренд.
3.  **Імпульс (RSI Filter):** Значення індикатора RSI знаходиться нижче рівня 50. Це свідчить про перевагу продавців. ( *Цей фільтр можна ввімкнути/вимкнути* )
4.  **Підтвердження обсягом (Volume Filter):** Обсяг поточної свічки перевищує середній обсяг. ( *Цей фільтр можна ввімкнути/вимкнути* )

## Управління ризиками: Stop Loss та Take Profit

Стратегія використовує динамічну систему управління ризиками, яка адаптується до поточної волатильності ринку.

### Stop Loss (SL)

Стоп-лос розраховується на основі індикатора **ATR (Average True Range)**.

*   **Формула:** `Ціна входу ± (sl_atr_multiplier * ATR)`
*   Це означає, що стоп-лос буде ширшим на волатильному ринку і вужчим на спокійному, що допомагає уникнути випадкового закриття позиції через ринковий шум.

### Take Profit (TP)

Тейк-профіт може розраховуватися двома методами, які можна обрати в конфігурації:

1.  **`rr_ratio` (за замовчуванням):**
    *   Розраховується на основі співвідношення ризику до прибутку.
    *   **Формула:** `Ризик (відстань до SL) * rr_ratio`
    *   Наприклад, якщо ризик на угоду становить 1%, а `rr_ratio` = 2.0, тейк-профіт буде встановлено на рівні +2% від ціни входу.

2.  **`local_extremum`:**
    *   Тейк-профіт встановлюється на рівні найближчого значущого максимуму (для Long) або мінімуму (для Short) за останній період.

## Параметри конфігурації

Усі параметри стратегії налаштовуються у файлі `configs/strategies/ema_trend_following.yaml`.

| Параметр              | Опис                                                                                             | Значення за замовчуванням |
| --------------------- | ------------------------------------------------------------------------------------------------ | ------------------------- |
| `fast_ema_period`     | Період для розрахунку швидкої EMA.                                                               | `20`                      |
| `slow_ema_period`     | Період для розрахунку повільної EMA.                                                              | `50`                      |
| `rsi_period`          | Період для розрахунку RSI.                                                                       | `14`                      |
| `volume_ma_period`    | Період для розрахунку середнього обсягу.                                                         | `20`                      |
| `atr_period`          | Період для розрахунку ATR.                                                                       | `14`                      |
| `kline_interval`      | Таймфрейм, на якому працює стратегія.                                                            | `'15m'`                   |
| `sl_atr_multiplier`   | Множник ATR для розрахунку стоп-лосу.                                                            | `1.5`                     |
| `rr_ratio`            | Співвідношення ризик/прибуток (використовується, якщо `tp_method` = `rr_ratio`).                  | `2.0`                     |
| `max_sl_percentage`   | Максимально допустимий Stop Loss у відсотках від ціни входу (напр., 0.05 = 5%).                   | `0.05`                    |
| `tp_method`           | Метод розрахунку тейк-профіту (`rr_ratio` або `local_extremum`).                                   | `'rr_ratio'`              |
| `use_rsi_filter`      | Вмикає або вимикає фільтр за RSI.                                                                | `true`                    |
| `use_volume_filter`   | Вмикає або вимикає фільтр за обсягом.                                                            | `true`                    |
