Загальна концепція

  Стратегія працює за принципом "йди за трендом". Вона використовує дві ковзні середні (EMA) для визначення напрямку тренду:
   * Швидка EMA (напр., за 20 періодів) реагує на останні зміни ціни.
   * Повільна EMA (напр., за 50 періодів) показує більш довгостроковий тренд.

  Коли швидка EMA перетинає повільну, це вважається сигналом про можливу зміну або початок нового тренду.

  ---

  Логіка сигналу на покупку (Long)

  Щоб стратегія згенерувала сигнал на покупку, повинні одночасно виконатися всі наступні умови:

   1. "Золотий хрест" (Golden Cross): Швидка EMA на поточній свічці стала вищою за повільну EMA, тоді як на попередній свічці вона була нижчою. Це ключовий сигнал про початок
      висхідного тренду.
   2. Висхідний нахил: Обидві EMA (і швидка, і повільна) спрямовані вгору. Це підтверджує, що тренд набирає силу, а не є випадковим коливанням.
   3. Сильний імпульс (фільтр RSI): Якщо увімкнено use_rsi_filter, індекс відносної сили (RSI) повинен бути вище 50. Це показує, що на ринку домінують покупці.
   4. Підтвердження обсягом (фільтр Volume): Якщо увімкнено use_volume_filter, обсяг торгів на сигнальній свічці має бути не нижчим за його середнє значення. Це свідчить про інтерес
      трейдерів до руху ціни вгору.

  Тільки якщо всі ці умови збігаються, бот генерує сигнал "Long".

  ---

  Логіка сигналу на продаж (Short)

  Сигнал на продаж є дзеркальним відображенням сигналу на покупку:

   1. "Хрест смерті" (Death Cross): Швидка EMA перетинає повільну EMA зверху вниз.
   2. Низхідний нахил: Обидві EMA спрямовані вниз.
   3. Слабкий імпульс (фільтр RSI): Якщо увімкнено, RSI має бути нижче 50, що вказує на перевагу продавців.
   4. Підтвердження обсягом (фільтр Volume): Так само, як і для Long, обсяг підтверджує силу руху.

  ---

  Управління ризиками (Stop Loss та Take Profit)

  Після входу в позицію стратегія одразу розраховує рівні виходу:

   * Stop Loss (SL): Рівень для обмеження збитків. Він розраховується на основі індикатора ATR (Average True Range), який вимірює волатильність ринку.
       * Формула: Ціна входу - (ATR * sl_atr_multiplier) для Long.
       * Це дозволяє ставити "ширший" стоп на волатильному ринку і "вужчий" — на спокійному.

   * Take Profit (TP): Рівень для фіксації прибутку. Розраховується одним із двох методів (tp_method):
       1. `rr_ratio` (за замовчуванням): Класичний метод на основі співвідношення ризику до прибутку. Якщо ваш ризик (відстань до SL) становить $10, а rr_ratio = 2.0, то TP буде
          встановлено на рівні, що дасть $20 прибутку.
       2. `local_extremum`: Стратегія шукає найближчий локальний максимум (для Long) або мінімум (для Short) за останній період і ставить TP на цей рівень.

  Таким чином, EmaTrendFollowingStrategy — це комплексна система, яка не просто знаходить точку входу, а й використовує додаткові фільтри для підвищення надійності сигналу та
  динамічно управляє ризиками.












  Стратегія EmaTrendFollowingStrategy є хорошою основою, але її можна значно покращити, додавши кілька механізмів для підвищення надійності та прибутковості.

  Ось мої головні рекомендації:

  1. Додати фільтр для бокового ринку (флету)

  Проблема: Найбільший ворог трендових стратегій — це "боковий" ринок (флет), коли ціна коливається в вузькому діапазоні без чіткого напрямку. У таких умовах EMA будуть часто
  перетинатися, генеруючи безліч збиткових угод (це називається "пила").

  Рішення: Додати індикатор, який визначає силу тренду. Найпопулярніший для цього — ADX (Average Directional Index).

   * Логіка: Перед тим, як розглядати сигнал від перетину EMA, перевірте значення ADX.
       * Якщо ADX нижче певного порогу (напр., 20 або 25), це означає, що тренд слабкий або відсутній. Усі сигнали від EMA в цей час слід ігнорувати.
       * Якщо ADX вище порогу, ринок знаходиться в тренді, і сигнали можна брати до уваги.

  Як реалізувати: Додати розрахунок ADX в методі check_signal і додати if current_candle['ADX_14'] > 25: як додаткову умову для входу.

  ---

  2. Реалізувати динамічний Take Profit (Trailing Stop Loss)

  Проблема: Поточний Take Profit є фіксованим (або за R:R, або за локальним екстремумом). Якщо починається сильний тренд, ваша позиція закриється з невеликим прибутком, втративши
  весь подальший великий рух.

  Рішення: Замінити статичний Take Profit на Trailing Stop Loss (плаваючий стоп-лос).

   * Логіка: Замість того, щоб ставити фіксовану ціль по прибутку, ви "підтягуєте" свій Stop Loss вгору (для Long) або вниз (для Short) по мірі руху ціни у вашому напрямку. Позиція
     закривається тільки тоді, коли ціна розвертається і досягає цього плаваючого стопа.
   * Популярні методи:
       * За EMA: Використовувати повільну EMA як лінію стоп-лосу. Позиція закривається, коли ціна перетинає її у зворотному напрямку.
       * За ATR: Тримати стоп-лос на відстані N * ATR від поточної ціни.

  Як реалізувати: Ця логіка ідеально підходить для методу analyze_and_adjust, який вже є у вашому базовому класі стратегії. У цьому методі ви можете перевіряти поточну ціну та
  розраховувати новий рівень для стоп-лосу, а потім віддавати команду на його переміщення.

  ---

  3. Вхід у позицію на відкаті (Pullback Entry)

  Проблема: Стратегія входить в угоду одразу в момент перетину EMA. Часто після першого імпульсу відбувається невеликий відкат (pullback) ціни назад до однієї з EMA. Входячи на
  піку імпульсу, ви ризикуєте отримати гіршу ціну входу.

  Рішення: Після отримання сигналу про перетин EMA, не входити одразу, а чекати на відкат.

   * Логіка:
       1. Стався "Золотий хрест" (сигнал Long).
       2. Не входимо, а чекаємо, поки ціна трохи скоригується вниз і торкнеться швидкої EMA.
       3. Якщо після торкання ціна знову починає рости, ось це і є кращий момент для входу.

  Як реалізувати: Це ускладнює логіку check_signal. Потрібно буде зберігати стан "сигнал є, чекаємо відкату" між викликами функції.

  ---

  Впровадження навіть перших двох пунктів (фільтр ADX та Trailing Stop) може кардинально змінити ефективність стратегії, зменшивши кількість збиткових угод у флеті та збільшивши
  прибуток від сильних трендів.